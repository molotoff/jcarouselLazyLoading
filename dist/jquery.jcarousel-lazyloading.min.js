!function(t){"use strict";t.jCarousel.isImagesLoaded=function(i){var n=i.find("img"),e=n.length,s=0;return t.each(n,function(){(function(t){return!!t.complete&&(void 0===t.naturalWidth||0!==t.naturalWidth)})(this)&&s++}),s===e},t.jCarousel.plugin("jcarouselLazyLoading",{_options:{preventScroll:!0,waitFunction:function(i,n,e){function s(){a++,t.jCarousel.isImagesLoaded(i)?(n(),o.removeClass("loading")):a<=100?setTimeout(s,100):(n(),o.removeClass("loading"))}var a=0,o=i.find("img[data-src],img[data-srcset],source[data-srcset],source[data-sizes]");o.toggleClass("non-transition",!!e),o.each(function(){var i=t(this),n=i.attr("data-src"),e=i.attr("data-srcset"),s=i.attr("data-sizes");i.addClass("loading"),i.attr("src",n).attr("srcset",e).attr("sizes",s).removeAttr("data-src").removeAttr("data-srcset").removeAttr("data-sizes"),"function"==typeof window.picturefill&&i.is("img")&&picturefill({reevaluate:!0,elements:[i[0]]})}),s()}},_loading:!1,_scrollPrevented:!1,_position:0,_init:function(){var i=this;this._instance=this.carousel().data("jcarousel"),this._element.on("jcarousel:reloadend.jcarouselLazyLoading",function(){i._reload()}).on("jcarousel:scroll.jcarouselLazyLoading",function(n,e,s,a){var o=i._position!==i._instance.list().position()[i._instance.lt];if(!i._loading&&!o&&i._options.preventScroll){var r=i._getNextVisibleSlides(s),c=function(){};i._scrollPrevented=i._loading=!0,t.isFunction(a)&&(c=a,a=!0),i._options.waitFunction(r,function(){i._scrollPrevented=!1,i._instance.scroll(s,a,function(){c(),i._loading=!1})},!0),n.preventDefault()}i._scrollPrevented&&n.preventDefault()}).on("jcarousel:scrollend.jcarouselLazyLoading",function(){!(i._position!==i._instance.list().position()[i._instance.lt])&&i._options.preventScroll||i._options.waitFunction(i._instance.visible(),function(){})}).on("jcarousel:animateend.jcarouselLazyLoading",function(){i._position=i._instance.list().position()[i._instance.lt]})},_create:function(){this._reload()},_getNextVisibleSlides:function(t){var i,n,e,s,a,o=this._instance.clipping(),r=this._instance.items().length,c=0;for(s=this._getSlide(t),i=this._instance.dimension(s),e=s,n=(a=s.index())+1>=r;i<o;)"circular"!==this._instance._options.wrap&&n?(c>0&&(c=0),c--):n=a+ ++c+1>=r,s=this._getSlide(a+c),i+=this._instance.dimension(s),e=e.add(s);return e},_getSlide:function(i){var n,e=t.jCarousel.parseTarget(i),s=this._instance.items().length;return e.relative?(n=this._instance.index(this._instance.target()),this._instance.items().eq((n+e.target)%s)):"number"==typeof e.target?this._instance.items().eq(e.target%s):e.target},_destroy:function(){this._element.off(".jcarouselLazyLoading")},_reload:function(){this._options.waitFunction(this._instance.visible(),function(){}),this._position=this._instance.list().position()[this._instance.lt]}})}(jQuery);