!function(t){"use strict";t.jCarousel.isImagesLoaded=function(n){var i=n.find("img"),e=i.length,s=0;return t.each(i,function(){(function(t){return!!t.complete&&(void 0===t.naturalWidth||0!==t.naturalWidth)})(this)&&s++}),s===e},t.jCarousel.plugin("jcarouselLazyLoading",{_options:{preventScroll:!0,waitFunction:function(n,i,e){function s(){o++,t.jCarousel.isImagesLoaded(n)?(i(),a.removeClass("loading")):o<=100?setTimeout(s,100):(i(),a.removeClass("loading"))}var o=0,a=n.find("img[data-src]");a.toggleClass("non-transition",!!e),a.each(function(){var n=t(this),i=n.attr("data-src");n.addClass("loading"),n.attr("src",i).removeAttr("data-src")}),s()}},_loading:!1,_scrollPrevented:!1,_position:0,_init:function(){var n=this;this._instance=this.carousel().data("jcarousel"),this._element.on("jcarousel:reloadend.jcarouselLazyLoading",function(){n._reload()}).on("jcarousel:scroll.jcarouselLazyLoading",function(i,e,s,o){var a=n._position!==n._instance.list().position()[n._instance.lt];if(!n._loading&&!a&&n._options.preventScroll){var r=n._getNextVisibleSlides(s),c=function(){};n._scrollPrevented=n._loading=!0,t.isFunction(o)&&(c=o,o=!0),n._options.waitFunction(r,function(){n._scrollPrevented=!1,n._instance.scroll(s,o,function(){c(),n._loading=!1})},!0),i.preventDefault()}n._scrollPrevented&&i.preventDefault()}).on("jcarousel:scrollend.jcarouselLazyLoading",function(){!(n._position!==n._instance.list().position()[n._instance.lt])&&n._options.preventScroll||n._options.waitFunction(n._instance.visible(),function(){})}).on("jcarousel:animateend.jcarouselLazyLoading",function(){n._position=n._instance.list().position()[n._instance.lt]})},_create:function(){this._reload()},_getNextVisibleSlides:function(t){var n,i,e,s,o,a=this._instance.clipping(),r=this._instance.items().length,c=0;for(s=this._getSlide(t),n=this._instance.dimension(s),e=s,i=(o=s.index())+1>=r;n<a;)"circular"!==this._instance._options.wrap&&i?(c>0&&(c=0),c--):i=o+ ++c+1>=r,s=this._getSlide(o+c),n+=this._instance.dimension(s),e=e.add(s);return e},_getSlide:function(n){var i,e=t.jCarousel.parseTarget(n),s=this._instance.items().length;return e.relative?(i=this._instance.index(this._instance.target()),this._instance.items().eq((i+e.target)%s)):"number"==typeof e.target?this._instance.items().eq(e.target%s):e.target},_destroy:function(){this._element.off(".jcarouselLazyLoading")},_reload:function(){this._options.waitFunction(this._instance.visible(),function(){}),this._position=this._instance.list().position()[this._instance.lt]}})}(jQuery);