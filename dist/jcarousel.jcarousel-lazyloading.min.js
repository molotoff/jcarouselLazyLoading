!function(t){"use strict";t.jCarousel.isImagesLoaded=function(n){function i(t){return t.complete?"undefined"!=typeof t.naturalWidth&&0===t.naturalWidth?!1:!0:!1}var e=n.find("img"),s=e.length,o=0;return t.each(e,function(){i(this)&&o++}),o===s},t.jCarousel.plugin("jcarouselLazyLoading",{_options:{preventScroll:!0,waitFunction:function(n,i){function e(){s++,t.jCarousel.isImagesLoaded(n)?i():100>=s?setTimeout(e,100):i()}var s=0;n.find("img[data-src]").each(function(){var n=t(this),i=n.attr("data-src");n.attr("src",i).removeAttr("data-src")}),e()}},_scrollPrevented:!1,_position:0,_init:function(){var n=this;this._instance=this.carousel().data("jcarousel"),this._element.on("jcarousel:reloadend.jcarouselLazyLoading",function(){n._reload()}).on("jcarousel:scroll.jcarouselLazyLoading",function(i,e,s,o){var a=n._position!==n._instance.list().position()[n._instance.lt];if(!n._scrollPrevented&&!a&&n._options.preventScroll){var c=n._getNextVisibleSlides(s),r=function(){};n._scrollPrevented=!0,t.isFunction(o)&&(r=o,o=!0),n._options.waitFunction(c,function(){n._instance.scroll(s,o,function(){r(),n._scrollPrevented=!1,n._position=n._instance.list().position()[n._instance.lt]})}),i.preventDefault()}}).on("jcarousel:scrollend.jcarouselLazyLoading",function(){var t=n._position!==n._instance.list().position()[n._instance.lt];(t||!n._options.preventScroll)&&n._options.waitFunction(n._instance.visible(),function(){})})},_create:function(){this._reload()},_getNextVisibleSlides:function(t){var n,i,e,s,o,a=this._instance.clipping(),c=this._instance.items().length,r=0;for(s=this._getSlide(t),n=this._instance.dimension(s),e=s,o=s.index(),i=o+1>=c;a>n;)"circular"!==this._instance._options.wrap&&i?(r>0&&(r=0),r--):(r++,i=o+r+1>=c),s=this._getSlide(o+r),n+=this._instance.dimension(s),e=e.add(s);return e},_getSlide:function(n){var i,e=t.jCarousel.parseTarget(n),s=this._instance.items().length;return e.relative?(i=this._instance.index(this._instance.target()),this._instance.items().eq((i+e.target)%s)):"number"==typeof e.target?this._instance.items().eq(e.target%s):e.target},_destroy:function(){this._element.off(".jcarouselLazyLoading")},_reload:function(){this._options.waitFunction(this._instance.visible(),function(){}),this._position=this._instance.list().position()[this._instance.lt]}})}(jQuery);